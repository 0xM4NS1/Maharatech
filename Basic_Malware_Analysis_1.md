# CH02_VID08_VM Network options (NAT, bridged, host-only)
NAT & Bridged can access to Network
Host-only we cant access the network

NAT : Network Addressed Translation : its like any process in my host machine .
Bridged : Vm conect direct to the router
Host_only: than not connected in the internet that have a different subnet

Should we allow the malware to access the internet : 
So let's explain what the malware can do when it is executed.
first malware want to connect with domain so
1 - Resolve the domain name to an ip address
2 - Connect to the server using its IP address 
    A - so if we just need to extract IOCs we turn of the network if we create a fake DNS when malware send to my fake DNS server  and send response No response
    B - if the malware type have multi stage  like went to  connect to the attacker server  to let the malware Download secound stage or grab an encryption / decryption key
  Precautions : 
  1 - Use a fake DNS server inside our subnet(host-only network)
  2 - Firewall like pfSense
  3 - Allow certain Protocols only (HTTP or ICMP)/
  4 - Always use a proxy or VPN tohide your location


Can Malware detect its runnung inside a VM ?
When and Why and wher 

some malware before it does any malicious activity, start checking if it running in a virtual machine.
Case : To deceive the sandbox and give false result .
Case : If he discovers that he is working on a virtual machine, he immediately terminates his work and deletes himself .
Case : Or during its operation, the malware makes sure that the Virtual Machine is not running, and if it detects it, it displays false results. For example, instead of connecting to the attackerâ€™s server, it connects to Google.
Case : To try to escape the VM and infect the host machine, find a vulnerability in the VM machine.


Note :  What is the VM and how it dose work ?
virtual machine (VM) is essentially a software emulation of a physical computer .
Type 1 Hypervisor (Bare-Metal):

Installs directly on hardware.
Manages VMs independently.
Examples: VMware ESXi, Microsoft Hyper-V, Xen.
Type 2 Hypervisor (Hosted):

Runs on top of an existing OS.
Relies on host OS for hardware access.
Examples: VMware Workstation, Oracle VirtualBox, Parallels Desktop.
How Hypervisors Work:
Abstraction: They create virtual versions of physical resources (CPU, memory, storage, network) for VMs.
Allocation: Assigns portions of physical resources to VMs based on needs.
Virtual Hardware: Presents virtual hardware to VMs, mimicking physical components.
Control: Manages and schedules access to physical resources among multiple VMs.
I/O Handling: Manages I/O operations between VMs and physical hardware.





How The malware detec if he in a vm ?
1 - The malware can detect the haypervisor  operating system uptime is < 1 hour
2 - VM hardware component ex disk size and ram
3 - guest Addition and vm tools  
4 - Files ex  no files in desktop or less of icon
5 - Registry 


Can the malware escape the machine and infect the host ? 
Yes 

When: after privilege evaluation
How  : guest to host exploit : 0-day exploits ,exploiting vuln in the hypervisor(VMM)






